<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Platform terintegrasi LMSt-OJK D.I.Y</title>
  <link rel="icon" type="image/png" href="https://ik.imagekit.io/logojkdiy/Layanan%20Terintegrasi%20-%20OJK%20DIY.png?updatedAt=." />
  <link rel="shortcut icon" type="image/png" href="https://ik.imagekit.io/logojkdiy/Layanan%20Terintegrasi%20-%20OJK%20DIY.png?updatedAt=." />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --primary:#8B1E24;
      --primary-900:#6F171C;
      --secondary:#FFE5EC; /* pink */
      --accent:#22D3EE;   /* cyan */
      --accent-2:#F59E0B; /* amber */
      --accent-3:#A78BFA; /* violet */
      --accent-4:#34D399; /* emerald */
      --accent-5:#10B981; /* green */
      --accent-6:#0EA5E9; /* blue */
      --accent-7:#8B5E3C; /* brown */
      --brand-blue:#1E40AF; /* matte blue */
      --brand-blue-hover:#1C3D99; /* darker matte blue */
      --text:#0B1222;
      --muted:#475569;
      --bg:#FFFFFF;
      --bg-soft:#FFF7F0;
      --event:#F59E0B;
    }
    /* Dark mode variables toggled by .theme-dark on html */
    html.theme-dark{ --text:#F3F4F6; --muted:#CBD5E1; --bg:#0B1222; --bg-soft:#0F172A; }
    body{font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans','Helvetica Neue',Arial; color:var(--text); background:var(--bg);}
    .font-heading{font-family:'Poppins',ui-sans-serif,system-ui;}

    /* Header styles */
    .glass{backdrop-filter:saturate(180%) blur(10px); background:rgba(255,255,255,.8);}
    .nav-link{position:relative; padding:.25rem .1rem;}
    .nav-link:after{
      content:""; position:absolute; left:0; bottom:-6px; height:3px; width:0%;
      background:linear-gradient(90deg,var(--primary),#C7363C); border-radius:9999px; transition:width .25s ease;
    }
    .nav-link:hover:after{width:100%;}
    .nav-link.active{color:var(--primary);}
    .nav-link.active:after{width:100%;}

    /* Buttons and cards */
    .btn-primary{background:var(--brand-blue); color:#fff; border-radius:9999px; padding:.8rem 1.15rem; font-weight:600; box-shadow:0 10px 20px rgba(30,64,175,.25); transition:transform .15s ease, box-shadow .2s ease, filter .2s ease;}
    .btn-primary:hover{transform:translateY(-2px); filter:saturate(1.0); box-shadow:0 14px 28px rgba(30,64,175,.35); background:var(--brand-blue-hover);}
    .btn-ghost{border:2px solid var(--primary); color:var(--primary); border-radius:9999px; padding:.7rem 1.05rem; font-weight:600; transition:all .2s ease;}
    .btn-ghost:hover{background:var(--primary); color:#fff; transform:translateY(-2px);}
    .btn-circle{width:44px;height:44px;border-radius:9999px;background:var(--primary);color:#fff; display:grid;place-items:center;box-shadow:0 10px 20px rgba(139,30,36,.18); transition:transform .2s ease, box-shadow .2s ease;}
    .btn-circle:hover{transform:translateY(-2px); box-shadow:0 14px 24px rgba(139,30,36,.22);}

    .card{background:linear-gradient(180deg,var(--bg) 0%,#FAFDFF 100%); border-radius:18px; box-shadow:0 10px 25px rgba(16,24,40,.06); transition:transform .2s ease, box-shadow .2s ease, filter .2s ease; border:1px solid #E6F4F1;}
    .card:hover{transform:translateY(-3px); box-shadow:0 16px 32px rgba(16,24,40,.10); filter:saturate(1.05);}

    /* Reveal */
    .reveal{opacity:0; transform:translateY(16px); transition:opacity .6s ease, transform .6s ease;}
    .reveal.in{opacity:1; transform:translateY(0);}

    /* Section waves */
    .wave-bottom{display:block; transform:translateY(1px);}

    /* Modal */
    .modal-backdrop{background:rgba(2,6,23,.6);}
    .modal-enter{opacity:0; transform:translateY(12px);}
    .modal-enter.in{opacity:1; transform:translateY(0); transition:opacity .25s ease, transform .25s ease;}

    /* Hotel slider */
    .carousel-track{transition: transform .5s cubic-bezier(.2,.8,.2,1); will-change: transform;}
    .dot{width:12px;height:12px;border-radius:9999px;background:rgba(139,30,36,.3);transition:transform .2s ease, background .2s ease;}
    .dot.active{background:var(--primary); transform:scale(1.15);}
    .hotel-badge{font-size:.75rem; background:#E8EEF8; color:#0B1222; border:1px solid #C9D7F2; padding:.25rem .65rem; border-radius:9999px; box-shadow:0 6px 14px rgba(30,64,175,.08);}

    /* Mobile menu sheet */
    .sheet{position:fixed; inset:0 0 0 auto; width:min(88vw,420px); background:#fff; box-shadow:-20px 0 40px rgba(2,6,23,.15); transform:translateX(100%); transition:transform .25s ease;}
    .sheet.open{transform:translateX(0);}

    /* Calendar */
    .cal-grid{display:grid; grid-template-columns: repeat(7, minmax(0,1fr)); gap:.5rem;}
    .cal-head{display:grid; grid-template-columns: repeat(7, minmax(0,1fr)); gap:.5rem; text-align:center; font-weight:600; color:var(--muted);}
    .cal-day{background:#fff; border:1px solid #EEF2F7; border-radius:14px; min-height:110px; padding:.6rem; display:flex; flex-direction:column; gap:.3rem;}
    .cal-day .date{font-weight:600; color:#475569;}
    .cal-day .badge{display:inline-block; max-width:100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; padding:.15rem .5rem; border-radius:9999px; background:linear-gradient(135deg,#FFF6E6,#E0FBFC); color:#92400E; border:1px solid #FDECC8; font-size:.72rem;}
    .cal-day.out{background:#FAFAFA;}
    .cal-day.today{outline:2px solid var(--primary); outline-offset:2px;}
    /* Lebar konten (1280–1440), tetap responsif */
    .max-w-7xl{max-width:1440px;}
    @media (min-width:1920px){
      body{max-width:1920px;margin:0 auto;}
    }
  </style>
</head>
<body class="antialiased">

  <!-- Header with enhanced navigation -->
  <header id="siteHeader" class="fixed top-0 left-0 right-0 z-50 glass border-b border-white/60" style="background:rgba(255,255,255,.9);">
    <div class="max-w-7xl mx-auto px-6">
      <div class="h-16 flex items-center justify-between">
        <a href="#hero" class="flex items-center gap-3 group">
          <div class="w-12 h-12 rounded-full bg-white grid place-items-center shadow-inner overflow-hidden ring-1 ring-gray-300">
            <img src="https://ik.imagekit.io/logojkdiy/Layanan%20Terintegrasi%20-%20OJK%20DIY.png?updatedAt=." alt="Logo" class="w-10 h-10 object-contain rounded-full" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <span class="font-heading text-lg text-[var(--primary)]">Platform terintegrasi LMSt-OJK D.I.Y</span>
        </a>

        <!-- Desktop nav -->
        <nav class="hidden lg:flex items-center gap-1 text-[var(--muted)] bg-white/40 backdrop-blur-md rounded-full px-2 py-1 shadow-md border border-white/50">
          <a href="#hero" class="nav-link px-4 py-2 rounded-full hover:bg-white/70">Home</a>
          <a href="#ruang-rapat" class="nav-link px-4 py-2 rounded-full hover:bg-white/70">Ruang Rapat</a>
          <a href="#hotel-partner" class="nav-link px-4 py-2 rounded-full hover:bg-white/70">Hotel Partner</a>
          <a href="#bantuan-teknis" class="nav-link px-4 py-2 rounded-full hover:bg-white/70">Bantuan Teknis</a>
          <a href="#cta" class="nav-link px-4 py-2 rounded-full hover:bg-white/70">Kontak</a>
        </nav>

        <div class="hidden lg:flex items-center gap-3">
          <!-- Mode controls -->
          <div class="hidden md:flex items-center gap-2 bg-white/60 rounded-full px-2 py-1 border border-white/70">
            <label for="modeSelect" class="text-xs text-[var(--muted)] ml-1">Mode</label>
            <select id="modeSelect" class="text-xs rounded-full border border-gray-300 px-3 py-1 bg-white text-[var(--text)] focus:outline-none">
              <option value="light">Terang</option>
              <option value="dark">Gelap</option>
            </select>
          </div>
        </div>

        <!-- Mobile -->
        <button class="lg:hidden btn-circle" id="openMenuBtn" aria-label="Buka menu">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 7h16M4 12h16M4 17h16" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
      </div>
    </div>

    <!-- Mobile Sheet -->
    <div id="mobileSheet" class="sheet lg:hidden">
      <div class="h-16 px-6 flex items-center justify-between border-b">
        <span class="font-heading text-[var(--primary)]">Menu</span>
        <button id="closeMenuBtn" class="btn-circle" aria-label="Tutup">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M6 6l12 12M18 6L6 18" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
      </div>
      <nav class="px-6 py-4 space-y-2 text-[var(--muted)]">
        <a href="#hero" class="block py-3 nav-link" onclick="closeSheet()">Home</a>
        <a href="#ruang-rapat" class="block py-3 nav-link" onclick="closeSheet()">Ruang Rapat</a>
        <a href="#mobil-dinas" class="block py-3 nav-link" onclick="closeSheet()">Mobil Dinas</a>
        <a href="#hotel-partner" class="block py-3 nav-link" onclick="closeSheet()">Hotel Partner</a>
        <a href="#bantuan-teknis" class="block py-3 nav-link" onclick="closeSheet()">Bantuan Teknis</a>
        <a href="#cta" class="block py-3 nav-link" onclick="closeSheet()">Kontak</a>
        <div class="pt-4 grid grid-cols-2 gap-2">
          <button id="mModeLight" class="hotel-badge text-xs">Terang</button>
          <button id="mModeDark" class="hotel-badge text-xs">Gelap</button>
        </div>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section id="hero" class="relative overflow-hidden pt-24 bg-white">

    <div class="pointer-events-none absolute inset-0">
      <div class="absolute -top-16 -left-20 w-96 h-96 rounded-full opacity-60 blur-2xl animate-pulse" style="background: radial-gradient(circle at 30% 30%, #FFE5EC, transparent 60%), radial-gradient(circle at 70% 40%, #E0FBFC, transparent 55%), radial-gradient(circle at 40% 80%, #FFF7F0, transparent 55%);"></div>
      <div class="absolute -bottom-24 -right-24 w-[28rem] h-[28rem] rounded-full" style="background: radial-gradient(closest-side, rgba(107,197,192,.25), transparent 70%);"></div>
    </div>
    <div class="relative max-w-7xl mx-auto px-6 py-16 md:py-24">
      <div class="grid md:grid-cols-2 gap-12 items-center">
        <div class="reveal">
          <h1 class="font-heading text-4xl md:text-5xl text-[var(--primary)] leading-tight">Platform Terintegrasi</h1>
          <p class="mt-4 text-[var(--muted)] text-lg">
            Selamat datang di Platform terintegrasi LMSt-OJK D.I.Y. Selamat menggunakan website ini.
          </p>
          <p class="mt-3 text-[var(--muted)]">
            Platform untuk meminjam ruang rapat, peminjaman kendaraan dinas, dan referensi hotel partner terpercaya di Yogyakarta.
          </p>
          <div class="mt-8 flex flex-wrap gap-3">
            <a href="#ruang-rapat" class="btn-primary">Jelajahi Ruang Rapat</a>
            <button class="btn-ghost" onclick="openFormModal('ruang')">Isi Formulir Ruang</button>
          </div>
        </div>
        <div class="reveal">
          <div class="card p-5">
            <svg class="w-full h-72" viewBox="0 0 640 320" fill="none">
              <rect x="0" y="0" width="640" height="320" rx="18" fill="#FFF4F4"/>
              <rect x="40" y="40" width="260" height="170" rx="14" fill="#FFFFFF" stroke="#8B1E24" stroke-opacity=".12"/>
              <rect x="330" y="60" width="270" height="120" rx="14" fill="#FFFFFF" stroke="#8B1E24" stroke-opacity=".12"/>
              <rect x="60" y="230" width="540" height="50" rx="12" fill="#F9E8E8"/>
              <circle cx="540" cy="240" r="34" fill="#C0A16B" fill-opacity=".7"/>
              <path d="M90 100h160M90 130h120M90 160h140" stroke="#8B1E24" stroke-opacity=".28" stroke-width="6" stroke-linecap="round"/>
              <path d="M360 90h220M360 120h180" stroke="#8B1E24" stroke-opacity=".28" stroke-width="6" stroke-linecap="round"/>
            </svg>
          </div>
        </div>
      </div>
    </div>
    <svg class="wave-bottom w-full text-white" viewBox="0 0 1440 90" preserveAspectRatio="none">
      <path fill="#FFFFFF" d="M0,64L48,53.3C96,43,192,21,288,21.3C384,21,480,43,576,53.3C672,64,768,64,864,69.3C960,75,1056,85,1152,80C1248,75,1344,53,1392,42.7L1440,32L1440,0L0,0Z"></path>
    </svg>
  </section>

  <!-- Kalender Kegiatan (di atas Pinjam Ruangan, tidak di navigasi) -->
  <section id="kalender-kegiatan" class="bg-white">
    <div class="max-w-7xl mx-auto px-6 pt-6 pb-6">
      <div class="card p-6">
        <div class="flex flex-col md:flex-row md:items-center gap-3 justify-between">
          <div>
            <h2 class="font-heading text-2xl text-[var(--primary)]">Kalender Kegiatan</h2>
            <p class="text-sm text-[var(--muted)]">Memuat jadwal dari spreadsheet Anda secara otomatis.</p>
          </div>
          <div class="flex items-center gap-2">
            <button class="btn-ghost text-sm" id="prevMonthBtn">Bulan Sebelumnya</button>
            <button class="btn-ghost text-sm" id="todayBtn">Hari Ini</button>
            <button class="btn-primary text-sm" id="nextMonthBtn">Bulan Berikutnya</button>
          </div>
        </div>

        <div class="mt-4 border rounded-2xl p-4 bg-[#FFF9F9] flex items-center gap-3" id="calLoading">
          <span class="inline-block w-3 h-3 rounded-full bg-[var(--primary)] animate-ping"></span>
          <span class="text-sm text-[var(--muted)]">Memuat data kalender dari CSV…</span>
        </div>
        <div class="mt-4 hidden" id="calError">
          <div class="p-4 rounded-xl border border-amber-200 bg-amber-50 text-amber-800 text-sm">
            Gagal memuat data kalender. Silakan cek koneksi atau izin berbagi CSV.
          </div>
        </div>

        <div class="mt-4">
          <div class="flex items-center justify-between gap-3 flex-wrap">
            <h3 id="calTitle" class="font-heading text-lg text-[var(--primary)]">—</h3>
            <div class="flex items-center gap-2 ml-auto">
              <button id="copyAgendaBtn" class="hotel-badge">Salin Rekap Bulan</button>
              <button id="copyTodayBtn" class="hotel-badge">Salin Agenda Hari Ini</button>
            </div>
          </div>
          <div class="mt-3 cal-head">
            <div class="text-[var(--primary)]">Sen</div><div class="text-[var(--primary)]">Sel</div><div class="text-[var(--primary)]">Rab</div><div class="text-[var(--primary)]">Kam</div><div class="text-[var(--primary)]">Jum</div><div class="text-[var(--primary)]">Sab</div><div class="text-[var(--primary)]">Min</div>
          </div>
          <div class="mt-2 cal-grid" id="calGrid" aria-label="Kalender Bulanan"></div>
          <div class="mt-4">
            <div class="text-sm font-semibold text-[var(--primary)] mb-2">Rekap Agenda Bulan Ini</div>
            <div id="agendaList" class="space-y-2 text-sm text-[var(--muted)]"></div>
            <div class="mt-3 flex items-center justify-between">
              <div class="text-xs text-[var(--muted)]" id="agendaInfo">Halaman 1</div>
              <div class="flex items-center gap-2">
                <button id="agendaPrev" class="hotel-badge">Sebelumnya</button>
                <button id="agendaNext" class="hotel-badge">Berikutnya</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <svg class="wave-bottom w-full" viewBox="0 0 1440 60" preserveAspectRatio="none">
      <path fill="#F7F7F9" d="M0,32L48,26.7C96,21,192,11,288,10.7C384,11,480,21,576,26.7C672,32,768,32,864,34.7C960,37,1056,43,1152,40C1248,37,1344,26,1392,21.3L1440,16L1440,0L0,0Z"></path>
    </svg>
  </section>

  <!-- Ruang Rapat -->
  <section id="ruang-rapat" class="bg-[#F7F7F9]">
    <div class="max-w-7xl mx-auto px-6 pt-4 pb-16">
      <div class="reveal text-center max-w-2xl mx-auto">
        <h2 class="font-heading text-3xl text-[var(--primary)]">Platform Terintegrasi</h2>
        <p class="mt-2 text-[var(--muted)]">Selamat menggunakan website ini. Temukan 9 Ruang Rapat yang Siap Mendukung Produktivitas Anda.</p>
      </div>

      <div class="mt-10 grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- 1 Bale Acitya -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ACITYA%201.png?updatedAt=." alt="Bale Acitya" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Bale Acitya</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas 30 orang</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Bale Acitya', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ACITYA%201.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ACITYA%202.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ACITYA%203.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>

        <!-- 2 Bale Astama -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ASTAMA%201.png?updatedAt=." alt="Bale Astama" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Bale Astama</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas 60 orang</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Bale Astama', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ASTAMA%201.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ASTAMA%202.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ASTAMA%203.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>

        <!-- 3 Nakula -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20NAKULA%201.png?updatedAt=." alt="Ruang Rapat Nakula" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Ruang Rapat Nakula</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas 8–10 orang</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Ruang Rapat Nakula', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20NAKULA%201.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20NAKULA%202.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20NAKULA%203.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>

        <!-- 4 Sadewa -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20SADEWA%201.png?updatedAt=." alt="Ruang Rapat Sadewa" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Ruang Rapat Sadewa</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas 8–10 orang</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Ruang Rapat Sadewa', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20SADEWA%201.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20SADEWA%202.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20SADEWA%203.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>

        <!-- 5 Bima -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20BIMA%201.png?updatedAt=." alt="Ruang Rapat Bima" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Ruang Rapat Bima</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas 20–35 orang</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Ruang Rapat Bima', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20BIMA%201.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20BIMA%202.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20BIMA%203.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>

        <!-- 6 Arjuna -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20ARJUNA%201.png?updatedAt=." alt="Ruang Rapat Arjuna" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Ruang Rapat Arjuna</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas 8–10 orang</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Ruang Rapat Arjuna', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20ROJ/ARJUNA1.png', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20ARJUNA%202.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20ARJUNA%203.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>

        <!-- 7 Ruang Rekreasi -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20REKREASI%201.png?updatedAt=." alt="Ruang Rekreasi" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Ruang Rekreasi</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas 30 orang</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Ruang Rekreasi', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20REKREASI%201.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20REKREASI%202.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20NAKULA%203.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>

        <!-- 8 Ballroom Indraprasta -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%201.png?updatedAt=." alt="Ballroom Indraprasta" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Ballroom Indraprasta</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas sesuai tata letak pada gambar</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Ballroom Indraprasta', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%201.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%202%20ROUND.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%203%20U%20SHAPE.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%204%20U%20SHAPE.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>

        <!-- 9 Bale Hinggil -->
        <article class="card p-4 reveal">
          <div class="aspect-[4/3] overflow-hidden rounded-xl">
            <img class="img-cover" src="https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20HINGGIL%201.png?updatedAt=." alt="Bale Hinggil" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          </div>
          <div class="mt-4">
            <h3 class="font-heading text-xl text-[var(--primary)]">Bale Hinggil</h3>
            <p class="mt-1 text-[var(--muted)]">Kapasitas 10–15 orang</p>
            <div class="mt-4 flex gap-2">
              <button class="btn-ghost text-sm" onclick="openGallery('Bale Hinggil', ['https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20HINGGIL%201.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20HINGGIL%202.png?updatedAt=.', 'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20HINGGIL%203.png?updatedAt=.'])">Lihat Detail &amp; Pinjam</button>
            </div>
          </div>
        </article>
      </div>
    </div>
    <svg class="wave-bottom w-full" viewBox="0 0 1440 90" preserveAspectRatio="none">
      <path fill="#FFFFFF" d="M0,64L48,53.3C96,43,192,21,288,21.3C384,21,480,43,576,53.3C672,64,768,64,864,69.3C960,75,1056,85,1152,80C1248,75,1344,53,1392,42.7L1440,32L1440,0L0,0Z"></path>
    </svg>
  </section>

  <!-- Mobil Dinas -->
  <section id="mobil-dinas" class="bg-white">
    <div class="max-w-7xl mx-auto px-6 py-14">
      <div class="grid md:grid-cols-2 gap-10 items-center">
        <div class="reveal">
          <h2 class="font-heading text-3xl text-[var(--primary)]">Kendaraan Dinas</h2>
          <p class="mt-3 text-[var(--muted)]">Pengajuan cepat, jadwal transparan, dan armada terawat untuk kebutuhan dinas Anda.</p>
          <ul class="mt-4 text-[var(--muted)] space-y-2">
            <li>• Driver profesional dan tepat waktu</li>
            <li>• Unit bersih dan terjadwal perawatan</li>
            <li>• Dukungan rute dalam dan luar kota</li>
          </ul>
          <div class="mt-6 flex flex-wrap gap-3">
            <button class="btn-primary" onclick="openFormModal('mobil')">Ajukan Peminjaman Mobil</button>
            <button class="btn-ghost" onclick="openProtokolModal()">Layanan Protokol</button>
          </div>
        </div>
        <div class="reveal relative">
          <div class="absolute -top-6 -left-6 w-24 h-24 bg-[var(--secondary)] rounded-full opacity-70 blur-xl"></div>
          <div class="absolute -bottom-6 -right-10 w-28 h-28 bg-[#FFEFD8] rounded-full opacity-70 blur-xl"></div>
          <div class="card p-6 relative">
            <div class="w-full h-64 rounded-xl bg-[var(--bg-soft)]"></div>
          </div>
        </div>
      </div>
    </div>
    <svg class="wave-bottom w-full" viewBox="0 0 1440 90" preserveAspectRatio="none">
      <path fill="#F7F7F9" d="M0,64L48,53.3C96,43,192,21,288,21.3C384,21,480,43,576,53.3C672,64,768,64,864,69.3C960,75,1056,85,1152,80C1248,75,1344,53,1392,42.7L1440,32L1440,0L0,0Z"></path>
    </svg>
  </section>

  <!-- Hotel Partner (15 referensi dengan detail) -->
  <section id="hotel-partner" class="bg-[#F7F7F9]">
    <div class="max-w-7xl mx-auto px-6 py-14">
      <div class="reveal text-center max-w-3xl mx-auto">
        <h2 class="font-heading text-3xl text-[var(--primary)]">Akomodasi Nyaman untuk Perjalanan Dinas Anda</h2>
        <p class="mt-2 text-[var(--muted)]">Hotel partner bintang 4–5 di Yogyakarta dengan lokasi strategis dan layanan terpercaya.</p>
      </div>

      <!-- Filter and quick nav -->
      <div class="mt-8 flex flex-col md:flex-row md:items-center gap-3">
        <div class="flex items-center gap-2">
          <button class="hotel-badge blue" onclick="filterHotels('all')">Semua</button>
          <button class="hotel-badge green" onclick="filterHotels('5')">⭐️⭐️⭐️⭐️⭐️</button>
          <button class="hotel-badge brown" onclick="filterHotels('4')">⭐️⭐️⭐️⭐️</button>
        </div>
        <div class="md:ml-auto">
          <input id="hotelSearch" type="text" placeholder="Cari hotel atau area..." class="w-full md:w-80 rounded-full border px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[var(--primary)]"/>
        </div>
      </div>

      <!-- Slider -->
      <div class="mt-8">
        <div class="overflow-hidden">
          <div id="hotelTrack" class="carousel-track grid grid-flow-col auto-cols-[85%] md:auto-cols-[45%] lg:auto-cols-[30%] gap-6"></div>
          <p class="mt-3 text-xs text-[var(--muted)]">Kartu hotel kini menampilkan foto. Klik “Tambah Foto” untuk menambah galeri khusus di detail.</p>
        </div>
        <div class="mt-6 flex items-center justify-center gap-4">
          <button aria-label="Sebelumnya" class="btn-circle" onclick="slideHotels(-1)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="flex items-center gap-2" id="dotsWrap"></div>
          <button aria-label="Berikutnya" class="btn-circle" onclick="slideHotels(1)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M9 6l6 6-6 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
        </div>
      </div>
    </div>
    <svg class="wave-bottom w-full" viewBox="0 0 1440 90" preserveAspectRatio="none">
      <path fill="#FFFFFF" d="M0,64L48,53.3C96,43,192,21,288,21.3C384,21,480,43,576,53.3C672,64,768,64,864,69.3C960,75,1056,85,1152,80C1248,75,1344,53,1392,42.7L1440,32L1440,0L0,0Z"></path>
    </svg>
      </div>
  </section>

  <!-- Bantuan Teknis -->
  <section id="bantuan-teknis" class="bg-white">
    <div class="max-w-7xl mx-auto px-6 py-14">
      <div class="reveal text-center max-w-3xl mx-auto">
        <h2 class="font-heading text-3xl text-[var(--primary)]">Dukungan Teknis Cepat dan Andal (Fitur Ini Dalam Tahap Pengembangan)</h2>
        <p class="mt-2 text-[var(--muted)]">Bantuan perangkat, jaringan, software, dan presentasi oleh teknisi berpengalaman.</p>
      </div>
      <div class="mt-10 grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
        <article class="reveal p-5 rounded-2xl" style="background:linear-gradient(135deg,#FFFFFF 0%,#FFF5F5 100%); box-shadow:0 10px 25px rgba(16,24,40,.08);">
          <div class="w-12 h-12 rounded-2xl bg-[var(--secondary)] grid place-items-center">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><rect x="3" y="4" width="18" height="12" rx="2" stroke="#8B1E24" stroke-width="2"/><path d="M8 20h8" stroke="#8B1E24" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <h3 class="font-heading text-xl mt-4 text-[var(--primary)]">Perangkat Komputer</h3>
          <p class="text-sm text-[var(--muted)] mt-1">Instalasi, troubleshooting, dan periferal kerja Anda.</p>
          <button class="btn-primary mt-4 text-sm" onclick="openFormModal('ruang')">Minta Bantuan</button>
        </article>
        <article class="reveal p-5 rounded-2xl" style="background:linear-gradient(135deg,#FFFFFF 0%,#FFF9F2 100%); box-shadow:0 10px 25px rgba(16,24,40,.08);">
          <div class="w-12 h-12 rounded-2xl bg-[var(--secondary)] grid place-items-center">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="#8B1E24" stroke-width="2"/><path d="M3 12h18M12 3a18 18 0 010 18M12 3a18 18 0 000 18" stroke="#8B1E24" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <h3 class="font-heading text-xl mt-4 text-[var(--primary)]">Jaringan</h3>
          <p class="text-sm text-[var(--muted)] mt-1">Internet, VPN, perangkat Wi‑Fi, dan LAN kantor.</p>
          <button class="btn-primary mt-4 text-sm" onclick="openFormModal('ruang')">Minta Bantuan</button>
        </article>
        <article class="reveal p-5 rounded-2xl" style="background:linear-gradient(135deg,#FFFFFF 0%,#FFF8F0 100%); box-shadow:0 10px 25px rgba(16,24,40,.08);">
          <div class="w-12 h-12 rounded-2xl bg-[var(--secondary)] grid place-items-center">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><rect x="4" y="3" width="16" height="18" rx="2" stroke="#8B1E24" stroke-width="2"/><path d="M8 7h8M8 11h8M8 15h8" stroke="#8B1E24" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <h3 class="font-heading text-xl mt-4 text-[var(--primary)]">Software</h3>
          <p class="text-sm text-[var(--muted)] mt-1">Instalasi aplikasi, update, lisensi, dan backup.</p>
          <button class="btn-primary mt-4 text-sm" onclick="openFormModal('ruang')">Minta Bantuan</button>
        </article>
        <article class="reveal p-5 rounded-2xl" style="background:linear-gradient(135deg,#FFFFFF 0%,#FFF6FF 100%); box-shadow:0 10px 25px rgba(16,24,40,.08);">
          <div class="w-12 h-12 rounded-2xl bg-[var(--secondary)] grid place-items-center">
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><rect x="4" y="5" width="16" height="10" rx="2" stroke="#8B1E24" stroke-width="2"/><path d="M12 15v4M8 19h8" stroke="#8B1E24" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <h3 class="font-heading text-xl mt-4 text-[var(--primary)]">Perangkat Presentasi</h3>
          <p class="text-sm text-[var(--muted)] mt-1">Proyektor, layar, pointer, dan kabel pendukung.</p>
          <button class="btn-primary mt-4 text-sm" onclick="openFormModal('ruang')">Minta Bantuan</button>
        </article>
      </div>
    </div>
  </section>

  <!-- Snack Box & Katering -->
  <section id="vendor-ref" class="bg-[#F7F7F9]">
    <div class="max-w-7xl mx-auto px-6 py-14">
      <div class="reveal text-center max-w-3xl mx-auto">
        <h2 class="font-heading text-3xl text-[var(--primary)]">Snack Box & Katering</h2>
        <p class="mt-2 text-[var(--muted)]">Ringkasan vendor pilihan untuk kebutuhan konsumsi acara Anda.</p>
      </div>

      <!-- Tabs -->
      <div class="mt-8 flex items-center justify-center gap-2">
        <button id="tabSnack" class="hotel-badge" onclick="switchVendorTab('snack')">Snack Box</button>
        <button id="tabCatering" class="hotel-badge" onclick="switchVendorTab('catering')">Katering</button>
      </div>


      <!-- Vendor list -->
      <div id="vendorList" class="mt-6 grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </div>
    <svg class="wave-bottom w-full" viewBox="0 0 1440 90" preserveAspectRatio="none">
      <path fill="#FFFFFF" d="M0,64L48,53.3C96,43,192,21,288,21.3C384,21,480,43,576,53.3C672,64,768,64,864,69.3C960,75,1056,85,1152,80C1248,75,1344,53,1392,42.7L1440,32L1440,0L0,0Z"></path>
    </svg>
      </div>
  </section>

  <!-- CTA -->
  <section id="cta" class="bg-white">
    <div class="max-w-7xl mx-auto px-6 py-14">
      <div class="reveal card p-8 md:p-10 relative overflow-hidden">
        <div class="absolute -right-16 -top-16 w-64 h-64 rounded-full" style="background: radial-gradient(closest-side, rgba(139,30,36,.12), transparent 70%);"></div>
        <div class="relative">
          <h2 class="font-heading text-3xl text-[var(--primary)]">Butuh Bantuan Lebih Lanjut?</h2>
          <p class="mt-2 text-[var(--muted)]">Hubungi kami, lihat FAQ, atau unduh panduan penggunaan.</p>
          <div class="mt-6 flex flex-wrap gap-3">
            <a href="#kontak" class="btn-primary">Hubungi Kami</a>
            <button class="btn-ghost" onclick="openInfo('FAQ')">Lihat FAQ</button>
            <button class="btn-ghost" onclick="downloadGuide()">Unduh Panduan</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer id="kontak" class="bg-[#0B1222] text-white">
    <div class="max-w-7xl mx-auto px-6 pt-16 pb-10">
      <div class="grid md:grid-cols-4 gap-10">
        <div>
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-full bg-white grid place-items-center overflow-hidden ring-1 ring-gray-400/70 shadow-sm">
              <img src="https://ik.imagekit.io/logojkdiy/Layanan%20Terintegrasi%20-%20OJK%20DIY.png?updatedAt=." alt="Logo" class="w-10 h-10 object-contain rounded-full" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
            </div>
            <span class="font-heading text-xl">Platform terintegrasi LMSt-OJK D.I.Y</span>
          </div>
          <p class="mt-4 text-sm text-white/70">Platform terintegrasi LMSt-OJK D.I.Y untuk pinjam ruang rapat, kendaraan dinas, dan referensi akomodasi.</p>
          <div class="mt-4 flex gap-3">
            <a href="https://instagram.com" target="_blank" rel="noopener noreferrer" class="w-9 h-9 rounded-full bg-white/10 grid place-items-center hover:bg-white/20">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="3" y="3" width="18" height="18" rx="5" stroke="white" stroke-width="2"/><circle cx="12" cy="12" r="4" stroke="white" stroke-width="2"/><circle cx="17.5" cy="6.5" r="1" fill="white"/></svg>
            </a>
            <a href="https://facebook.com" target="_blank" rel="noopener noreferrer" class="w-9 h-9 rounded-full bg-white/10 grid place-items-center hover:bg-white/20">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M15 8h-2a2 2 0 00-2 2v10" stroke="white" stroke-width="2" stroke-linecap="round"/><path d="M11 14h3l1-4h-4V8a1 1 0 011-1h3" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>
            </a>
            <a href="https://linkedin.com" target="_blank" rel="noopener noreferrer" class="w-9 h-9 rounded-full bg-white/10 grid place-items-center hover:bg-white/20">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="3" y="3" width="18" height="18" rx="2" stroke="white" stroke-width="2"/><path d="M8 10v7M8 7h.01M12 17v-5a2 2 0 114 0v5" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>
            </a>
          </div>
        </div>
        <div>
          <h4 class="font-heading text-lg mb-3">Kontak</h4>
          <ul class="space-y-2 text-sm text-white/80">
            <li>Alamat: Jl. Jend. Sudirman No.22, Gowongan, Kec. Jetis, Kota Yogyakarta, Daerah Istimewa Yogyakarta 55233</li>
            <li>Telepon: (0274) 460 5790</li>
            <li>WhatsApp Konsumen: 157 (Telepon) dan 081157157157 (WhatsApp)</li>
            <li>Email: konsumen@ojk.go.id</li>
          </ul>
        </div>
        <div>
          <h4 class="font-heading text-lg mb-3">Peta Situs</h4>
          <ul class="space-y-2 text-sm text-white/80">
            <li><a href="#ruang-rapat" class="hover:underline">Ruang Rapat</a></li>
            <li><a href="#mobil-dinas" class="hover:underline">Mobil Dinas</a></li>
            <li><a href="#hotel-partner" class="hover:underline">Hotel Partner</a></li>
            <li><a href="#bantuan-teknis" class="hover:underline">Bantuan Teknis</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-heading text-lg mb-3">Kebijakan</h4>
          <ul class="space-y-2 text-sm text-white/80">
            <li><a href="#" onclick="openInfo('Kebijakan Privasi')" class="hover:underline">Kebijakan Privasi</a></li>
            <li><a href="#" onclick="openInfo('Syarat & Ketentuan')" class="hover:underline">Syarat & Ketentuan</a></li>
          </ul>
        </div>
      </div>
      <div class="mt-10 pt-6 border-t border-white/10 text-xs text-white/60">
        © <span id="y"></span> Platform terintegrasi LMSt-OJK D.I.Y. Seluruh hak cipta dilindungi.
      </div>
    </div>
  </footer>

  <!-- Gallery Modal -->
  <div id="galleryModal" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
    <div class="absolute inset-0" onclick="closeGallery()"></div>
    <div class="relative z-10 w-[92%] max-w-3xl card p-4 modal-enter">
      <div class="flex items-center justify-between">
        <h3 id="galleryTitle" class="font-heading text-xl text-[var(--primary)]">Galeri Ruang</h3>
        <button class="btn-ghost py-2 px-3" onclick="closeGallery()">Tutup</button>
      </div>
      <div class="mt-3 relative">
        <div id="galleryViewport" class="overflow-hidden rounded-xl">
          <div id="galleryTrack" class="grid grid-flow-col auto-cols-[100%] gap-4 transition-transform duration-300"></div>
        </div>
        <div class="mt-4 flex items-center justify-between">
          <button class="btn-circle" onclick="gallerySlide(-1)" aria-label="Sebelumnya">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="flex items-center gap-2">
            <button class="btn-primary" onclick="openFormModal('ruang')">Ajukan Peminjaman</button>
            <button class="btn-ghost" onclick="closeGallery()">Tutup</button>
          </div>
          <button class="btn-circle" onclick="gallerySlide(1)" aria-label="Berikutnya">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M9 6l6 6-6 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Form Modal (pratinjau; tanpa URL tampil) -->
  <div id="formModal" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
    <div class="absolute inset-0" onclick="closeFormModal()"></div>
    <div class="relative z-10 w-[92%] max-w-3xl card p-6 modal-enter">
      <h3 id="formTitle" class="font-heading text-xl text-[var(--primary)]">Pratinjau Formulir</h3>
      <p class="mt-2 text-sm text-[var(--muted)]">Formulir ditampilkan langsung di area bawah. Jika tidak muncul, kemungkinan dibatasi oleh sumber eksternal.</p>
      <div class="mt-4 p-4 rounded-xl border border-red-100 bg-[#FFF7F7] text-sm text-[var(--muted)]">
        <p class="mb-2 font-semibold text-[var(--primary)]">Panduan singkat pengisian:</p>
        <ul class="list-disc pl-5 space-y-1">
          <li>Isi data identitas dan unit kerja dengan benar.</li>
          <li>Pilih tanggal, waktu, dan kebutuhan fasilitas secara lengkap.</li>
          <li>Pastikan nomor kontak aktif untuk konfirmasi.</li>
          <li>Periksa kembali sebelum menekan tombol Kirim pada formulir.</li>
        </ul>
      </div>
      <div class="mt-4 relative">
        <div id="formLoading" class="absolute inset-0 z-10 flex items-center justify-center bg-white/80 rounded-xl border border-red-100">
          <div class="flex items-center gap-3">
            <span class="inline-block w-3 h-3 rounded-full bg-[var(--primary)] animate-ping"></span>
            <span class="text-sm text-[var(--muted)]">Memuat pratinjau formulir…</span>
          </div>
        </div>
        <iframe id="form-iframe" title="Pratinjau Formulir" src="" width="100%" height="600" frameborder="0" marginheight="0" marginwidth="0" class="rounded-xl shadow-lg transition-opacity duration-500 opacity-0 bg-white"></iframe>
      </div>
      <div class="mt-5 flex flex-wrap items-center justify-end gap-2">
        <button class="btn-primary" onclick="closeFormModal()">Tutup Form</button>
      </div>
    </div>
  </div>

  <!-- Hotel Detail Modal -->
  <div id="hotelModal" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
    <div class="absolute inset-0" onclick="closeHotelModal()"></div>
    <div class="relative z-10 w-[92%] max-w-3xl card p-6 modal-enter">
      <div class="flex items-center justify-between">
        <h3 id="hotelTitle" class="font-heading text-xl text-[var(--primary)]">Detail Hotel</h3>
        <button class="btn-ghost" onclick="closeHotelModal()">Tutup</button>
      </div>
      <div class="mt-3 grid md:grid-cols-3 gap-6">
        <div class="md:col-span-2 space-y-3 text-sm text-[var(--muted)]" id="hotelDetail"></div>
        <div class="space-y-3">
          <div class="p-4 rounded-xl border">
            <p class="text-sm font-semibold text-[var(--primary)] mb-1">Kontak & Lokasi</p>
            <div class="text-sm text-[var(--muted)]" id="hotelContact"></div>
          </div>
          <div class="p-4 rounded-xl border">
            <p class="text-sm font-semibold text-[var(--primary)] mb-1">Catatan</p>
            <div class="text-sm text-[var(--muted)]" id="hotelNotes"></div>
          </div>
        </div>
      </div>
      <div class="mt-4">
        <div id="hotelGallery" class="grid grid-cols-2 md:grid-cols-3 gap-3"></div>
      </div>
    </div>
  </div>

  <!-- Protokol Modal -->
  <div id="protokolModal" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
    <div class="absolute inset-0" onclick="closeProtokolModal()"></div>
    <div class="relative z-10 w-[92%] max-w-md card p-6 modal-enter">
      <div class="flex items-center justify-between">
        <h3 class="font-heading text-xl text-[var(--primary)]">Layanan Protokol</h3>
        <button class="btn-ghost" onclick="closeProtokolModal()">Tutup</button>
      </div>
      <p class="mt-2 text-sm text-[var(--muted)]">Silakan hubungi nomor berikut (akan diisi WhatsApp masing-masing):</p>
      <div class="mt-4 space-y-2">
        <button class="btn-ghost w-full" onclick="openWhatsApp('PROTOKOL_I')">Protokol I</button>
        <button class="btn-ghost w-full" onclick="openWhatsApp('PROTOKOL_II')">Protokol II</button>
        <button class="btn-ghost w-full" onclick="openWhatsApp('PROTOKOL_III')">Protokol III</button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 hidden">
    <div class="px-4 py-3 bg-emerald-600 text-white rounded-full shadow-lg">Unduhan dimulai…</div>
  </div>

  <!-- Welcome Popup -->
  <div id="welcomePopup" class="fixed inset-0 z-[60] hidden items-center justify-center">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="relative z-10 max-w-md w-[92%] card p-6 text-center">
      <h3 class="font-heading text-2xl text-[var(--primary)]">Selamat Datang!</h3>
      <p class="mt-2 text-[var(--muted)]">Terima kasih telah mengakses Platform terintegrasi LMSt-OJK D.I.Y. Selamat menggunakan website ini.</p>
      <button id="welcomeClose" class="btn-primary mt-4">Mulai Jelajah</button>
    </div>
  </div>

  <script>
    // Tahun berjalan
    document.getElementById('y').textContent = new Date().getFullYear();

    // THEME: Soft vs Vivid + Light vs Dark + Batik pattern
    const htmlEl = document.documentElement;

    function setMode(mode){
      htmlEl.classList.toggle('theme-dark', mode==='dark');
      localStorage.setItem('themeMode', mode);
      document.body.style.background = getComputedStyle(htmlEl).getPropertyValue('--bg');
    }

    // Restore saved
    const savedMode = localStorage.getItem('themeMode') || 'light';
    setMode(savedMode);

    // Header controls
    // Desktop dropdown control
    const modeSelect = document.getElementById('modeSelect');
    if(modeSelect){
      modeSelect.value = savedMode;
      modeSelect.addEventListener('change', (e)=> setMode(e.target.value));
    }

    // Mobile controls
    document.getElementById('mModeLight')?.addEventListener('click', ()=> { setMode('light'); closeSheet(); });
    document.getElementById('mModeDark')?.addEventListener('click', ()=> { setMode('dark'); closeSheet(); });

    // Welcome popup muncul 5 detik lalu hilang
    const wp = document.getElementById('welcomePopup');
    const wpClose = document.getElementById('welcomeClose');
    function hideWelcome(){ wp.classList.add('hidden'); wp.classList.remove('flex'); }
    function showWelcome(){ wp.classList.remove('hidden'); wp.classList.add('flex'); }
    // tampilkan saat load
    showWelcome();
    let welcomeTimer = setTimeout(hideWelcome, 5000);
    wpClose.addEventListener('click', ()=>{ hideWelcome(); clearTimeout(welcomeTimer); });

    // Scroll reveal
    const io = new IntersectionObserver((entries)=>entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target); } }),{threshold:.15});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    // Enhanced header: shadow on scroll + scrollspy
    const header = document.getElementById('siteHeader');
    const links = Array.from(document.querySelectorAll('header .nav-link'));
    const sections = ['hero','ruang-rapat','mobil-dinas','hotel-partner','bantuan-teknis','cta'].map(id=>document.getElementById(id));
    function onScroll(){
      header.style.boxShadow = window.scrollY>10 ? '0 6px 24px rgba(2,6,23,.08)' : 'none';
      // Scrollspy
      let current = sections[0]?.id;
      for(const sec of sections){
        if(sec && window.scrollY + 140 >= sec.offsetTop) current = sec.id;
      }
      links.forEach(a=>{
        a.classList.toggle('active', a.getAttribute('href') === '#'+current);
      });
    }
    window.addEventListener('scroll', onScroll); onScroll();

    // Mobile sheet
    const sheet = document.getElementById('mobileSheet');
    document.getElementById('openMenuBtn').onclick = ()=>sheet.classList.add('open');
    document.getElementById('closeMenuBtn').onclick = ()=>sheet.classList.remove('open');
    function closeSheet(){ sheet.classList.remove('open'); }

    // Gallery placeholder
    let galleryIndex = 0;
    function openGallery(title, images){
      const modal = document.getElementById('galleryModal');
      const track = document.getElementById('galleryTrack');
      document.getElementById('galleryTitle').textContent = title || 'Galeri';

      // Peta default: gunakan foto-foto ruangan yang sudah dikirim sebelumnya
      const DEFAULT_GALLERY = {
        'Bale Acitya': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ACITYA%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ACITYA%202.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ACITYA%203.png?updatedAt=.'
        ],
        'Bale Astama': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ASTAMA%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ASTAMA%202.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20ASTAMA%203.png?updatedAt=.'
        ],
        'Ruang Rapat Nakula': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20NAKULA%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20NAKULA%202.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20NAKULA%203.png?updatedAt=.'
        ],
        'Ruang Rapat Sadewa': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20SADEWA%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20SADEWA%202.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20SADEWA%203.png?updatedAt=.'
        ],
        'Ruang Rapat Bima': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20BIMA%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20BIMA%202.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20BIMA%203.png?updatedAt=.'
        ],
        'Ruang Rapat Arjuna': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20ARJUNA%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20ARJUNA%202.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20ARJUNA%203.png?updatedAt=.'
        ],
        'Ruang Rekreasi': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20REKREASI%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/RUANG%20REKREASI%202.png?updatedAt=.'
        ],
        'Ballroom Indraprasta': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%202%20ROUND.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%203%20U%20SHAPE.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALL%20INDRAPRASTA%204%20U%20SHAPE.png?updatedAt=.'
        ],
        'Bale Hinggil': [
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20HINGGIL%201.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20HINGGIL%202.png?updatedAt=.',
          'https://ik.imagekit.io/logojkdiy/KATALOG%20RUANGAN%20OJK%20DIY/OJK%20DIY%20-%20KATALOG%20RUANGAN%20III/BALE%20HINGGIL%203.png?updatedAt=.'
        ]
      };

      const sourceImages = (images && images.length) ? images : (DEFAULT_GALLERY[title] || []);

      track.innerHTML = '';
      if(sourceImages.length){
        sourceImages.forEach((url)=>{
          const cell = document.createElement('div');
          cell.className = 'aspect-[4/3] rounded-xl overflow-hidden';
          const img = document.createElement('img');
          img.className = 'img-cover';
          img.src = url;
          img.alt = title || 'Foto Ruang';
          img.onerror = function(){ this.src=''; this.alt='Image failed to load'; this.style.display='none'; };
          cell.appendChild(img);
          track.appendChild(cell);
        });
      } else {
        // Fallback jika benar-benar tidak ada sumber gambar
        [1,2,3].forEach((i)=>{
          const cell = document.createElement('div');
          cell.className = 'aspect-[4/3] rounded-xl overflow-hidden grid place-items-center bg-[#FFF4F4]';
          const ph = document.createElement('div');
          ph.className='text-[var(--muted)]';
          ph.textContent = 'Tidak ada gambar';
          cell.appendChild(ph);
          track.appendChild(cell);
        });
      }

      galleryIndex = 0;
      track.style.transform = 'translateX(0px)';
      modal.classList.remove('hidden'); modal.classList.add('flex');
      requestAnimationFrame(()=>modal.querySelector('.modal-enter').classList.add('in'));
    }
    function closeGallery(){
      const modal = document.getElementById('galleryModal');
      modal.classList.add('hidden'); modal.classList.remove('flex');
      modal.querySelector('.modal-enter').classList.remove('in');
    }
    function gallerySlide(dir){
      const track = document.getElementById('galleryTrack');
      const total = track.children.length;
      galleryIndex = Math.max(0, Math.min(total-1, galleryIndex + dir));
      const w = track.children[0]?.getBoundingClientRect().width || 0;
      const gap = 16;
      track.style.transform = `translateX(${-galleryIndex * (w + gap)}px)`;
    }

    // Form modal (pratinjau)
    const FORM_URLS = {
      ruang: "https://script.google.com/macros/s/AKfycbzlnt9zi0opCTMNBAqE6Ttp1qfeSN_04Ch9SPoJYKSOLJQVPafUePq6S9vKtSxz0X8f/exec",
      mobil: "https://script.google.com/macros/s/AKfycbwqf8-2eqTF7pTxjH9J1xRN2qEFc6eLMZJKIvAoDwh0dPoFmoPmKnSDnhpahrGX4e94/exec"
    };
    function openFormModal(type){
      const modal = document.getElementById('formModal');
      const title = document.getElementById('formTitle');
      const iframe = document.getElementById('form-iframe');
      const loading = document.getElementById('formLoading');
      title.textContent = type === 'mobil' ? 'Pratinjau Formulir Peminjaman Mobil' : 'Pratinjau Formulir Peminjaman Ruang Rapat';
      iframe.style.opacity = '0';
      loading.classList.remove('hidden');
      let loaded=false;
      iframe.onload = function(){ loaded=true; setTimeout(()=>{ loading.classList.add('hidden'); iframe.style.opacity='1'; }, 200); };
      iframe.src = FORM_URLS[type] || FORM_URLS.ruang;
      modal.classList.remove('hidden'); modal.classList.add('flex');
      requestAnimationFrame(()=>modal.querySelector('.modal-enter').classList.add('in'));
      setTimeout(()=>{ if(!loaded){ loading.classList.add('hidden'); } }, 3000);
    }
    function closeFormModal(){
      const modal = document.getElementById('formModal');
      const iframe = document.getElementById('form-iframe');
      iframe.src = '';
      modal.classList.add('hidden'); modal.classList.remove('flex');
      modal.querySelector('.modal-enter').classList.remove('in');
    }

    // Hotel data (15 referensi bintang 4–5 di Yogyakarta)
    const hotels = [
      {id:'marriott', name:'Yogyakarta Marriott Hotel', stars:5, rating:4.7, area:'Seturan / Utara Kota', address:'Jln. Ringroad Utara, Depok, Sleman', phone:'+62 274 6000888', distance:'Dekat Hartono Mall (±300m)', amenities:['Kolam renang','Pusat kebugaran','Ballroom besar','Restoran'], notes:'Cocok untuk MICE skala besar', link:'https://www.marriott.com'},
      {id:'royalambarrukmo', name:'Royal Ambarrukmo Yogyakarta', stars:5, rating:4.7, area:'Caturtunggal', address:'Jl. Laksda Adisucipto No.81, Sleman', phone:'+62 274 488488', distance:'Terkoneksi Plaza Ambarrukmo', amenities:['Heritage','Kolam renang','Spa','Restoran'], notes:'Sentuhan heritage Jawa modern', link:'https://www.royalambarrukmo.com'},
      {id:'melia', name:'Melia Purosani Yogyakarta', stars:5, rating:4.6, area:'Pusat Kota', address:'Jl. Suryotomo No.31, Yogyakarta', phone:'+62 274 589521', distance:'±5 menit ke Malioboro', amenities:['Kolam renang','Spa','Taman tropis','Restoran'], notes:'Lingkungan hijau di tengah kota', link:'https://www.melia.com'},
      {id:'sheraton', name:'Sheraton Mustika Yogyakarta', stars:5, rating:4.5, area:'Dekat Bandara Adisutjipto', address:'Jl. Laksda Adisucipto KM 8.7, Sleman', phone:'+62 274 488588', distance:'Akses cepat ke bandara lama', amenities:['Kolam renang grotto','Spa','Lapangan tenis'], notes:'Resor bergaya klasik', link:'https://www.marriott.com'},
      {id:'tentrem', name:'Hotel Tentrem Yogyakarta', stars:5, rating:4.8, area:'Jetis / Utara Kota', address:'Jl. P. Mangkubumi No.72A, Yogyakarta', phone:'+62 274 6415555', distance:'±8 menit ke Tugu Jogja', amenities:['Kolam renang','Spa','Gym besar','Restoran'], notes:'Mewah dan sangat nyaman', link:'https://www.tentremhotels.com'},
      {id:'hyatt', name:'Hyatt Regency Yogyakarta', stars:5, rating:4.7, area:'Utara Kota', address:'Jl. Palagan Tentara Pelajar, Sleman', phone:'+62 274 869123', distance:'Taman luas & lapangan golf mini', amenities:['Resort garden','Kolam renang','Golf mini','Spa'], notes:'Suasana resort yang tenang', link:'https://www.hyatt.com'},
      {id:'phoenix', name:'The Phoenix Hotel Yogyakarta (MGallery)', stars:5, rating:4.6, area:'Pusat Kota', address:'Jl. Jend. Sudirman No.9, Yogyakarta', phone:'+62 274 566617', distance:'Dekat Tugu Jogja', amenities:['Heritage kolonial','Kolam','Restoran'], notes:'Ikonik dan bersejarah', link:'https://all.accor.com'},
      {id:'eastparc', name:'Eastparc Hotel Yogyakarta', stars:5, rating:4.7, area:'Jalan Laksda Adisutjipto', address:'Jl. Laksda Adisutjipto KM 6.5, Sleman', phone:'+62 274 4932000', distance:'Dekat mall & kuliner', amenities:['Taman bermain','Kolam','Restoran keluarga'], notes:'Ramah keluarga dengan playground', link:'https://www.eastparc.com'},
      {id:'grandmercure', name:'Grand Mercure Yogyakarta Adi Sucipto', stars:4, rating:4.5, area:'Adi Sucipto', address:'Jl. Laksda Adisucipto No.80, Yogyakarta', phone:'+62 274 2924000', distance:'Akses mudah ke pusat kota', amenities:['Kolam','Spa','Rooftop bar'], notes:'Modern dan efisien', link:'https://all.accor.com'},
      {id:'novotel', name:'Novotel Yogyakarta', stars:4, rating:4.4, area:'Jl. Sudirman', address:'Jl. Jend. Sudirman No.89, Yogyakarta', phone:'+62 274 580930', distance:'Koridor bisnis pusat', amenities:['Kolam','Gym','Spa'], notes:'Pilihan bisnis nyaman', link:'https://all.accor.com'},
      {id:'alana', name:'The Alana Yogyakarta Hotel & Convention Center', stars:4, rating:4.5, area:'Ringroad Utara', address:'Jalan Palagan KM 7, Sleman', phone:'+62 274 888800', distance:'Akses ke ringroad cepat', amenities:['Ballroom','Kolam','Restoran'], notes:'Cocok untuk acara besar', link:'https://www.alana-hotels.com'},
      {id:'swissbel', name:'Swiss-Belboutique Yogyakarta', stars:4, rating:4.5, area:'Jl. Dagen / Malioboro area', address:'Jl. Jend. Sudirman No.69, Yogyakarta', phone:'+62 274 2921888', distance:'Dekat pusat belanja', amenities:['Rooftop pool','Spa','Restoran'], notes:'Trendi & strategis', link:'https://www.swiss-belhotel.com'},
      {id:'eastplaza', name:'Hotel Grand Rohan Jogja', stars:4, rating:4.5, area:'Ringroad Timur', address:'Jl. Janti No.336, Yogyakarta', phone:'+62 274 2802888', distance:'Dekat kampus UIN', amenities:['Kolam','Restoran','Ballroom'], notes:'Akses cepat ke timur kota', link:'https://grandrohan.com'},
      {id:'gaia', name:'GAIA Cosmo Hotel', stars:4, rating:4.4, area:'Jl. Ipda Tut Harsono', address:'Jl. Ipda Tut Harsono No.16, Umbulharjo', phone:'+62 274 5305888', distance:'Dekat area kuliner', amenities:['Desain modern','Restoran','Meeting'], notes:'Gaya kontemporer', link:'https://gaiacosmo.com'},
      {id:'harper', name:'Harper Malioboro Yogyakarta', stars:4, rating:4.4, area:'Malioboro Area', address:'Jl. Mangkubumi No.52, Yogyakarta', phone:'+62 274 2920000', distance:'±5 menit ke Malioboro', amenities:['Kolam','Restoran','Meeting'], notes:'Dekat ikon wisata', link:'https://www.harperhotels.com'}
    ];

    const HOTEL_IMAGES = {
      marriott: 'https://ik.imagekit.io/logojkdiy/HOTEL%20JW%20MARRIOTT.png?updatedAt=.',
      royalambarrukmo: 'https://ik.imagekit.io/logojkdiy/HOTEL%20ROYAL%20AMBARRUKMO.png?updatedAt=.',
      melia: 'https://ik.imagekit.io/logojkdiy/HOTEL%20MELIA.png?updatedAt=.',
      sheraton: 'https://ik.imagekit.io/logojkdiy/HOTEL%20MUSTIKA.png?updatedAt=.',
      tentrem: 'https://ik.imagekit.io/logojkdiy/HOTEL%20TENTREM.png?updatedAt=.',
      swissbel: 'https://ik.imagekit.io/logojkdiy/HOTEL%20SWISSBELL.png?updatedAt=.',
      eastparc: 'https://ik.imagekit.io/logojkdiy/HOTEL%20EASTPARC.png?updatedAt=.',
      grandmercure: 'https://ik.imagekit.io/logojkdiy/HOTEL%20GRAND%20MERCURE.png?updatedAt=.',
      eastplaza: 'https://ik.imagekit.io/logojkdiy/HOTEL%20ROHAN.png?updatedAt=.',
      phoenix: 'https://ik.imagekit.io/logojkdiy/HOTEL%20PHOENIX.png?updatedAt=.',
      hyatt: 'https://ik.imagekit.io/logojkdiy/HOTEL%20HYATT.png?updatedAt=.',
      harper: 'https://ik.imagekit.io/logojkdiy/HOTEL%20HARPER.png?updatedAt=.',
      alana: 'https://ik.imagekit.io/logojkdiy/HOTEL%20THE%20ALANA.png?updatedAt=.'
    };

    const hotelTrack = document.getElementById('hotelTrack');
    const dotsWrap = document.getElementById('dotsWrap');
    let filtered = [...hotels];
    function starEmoji(n){ return '⭐️'.repeat(n); }
    function renderHotels(){
      hotelTrack.innerHTML = '';
      filtered.forEach(h=>{
        const card = document.createElement('article');
        card.className = 'card p-5';
        const imgUrl = HOTEL_IMAGES[h.id];
        card.innerHTML = `
          <div class="rounded-xl overflow-hidden aspect-[16/9] bg-white/70">
            ${imgUrl ? `<img src="${imgUrl}" alt="Foto ${h.name}" class="w-full h-full object-cover" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">` : `<div class='w-full h-full grid place-items-center text-[var(--muted)]'>Belum ada foto</div>`}
          </div>
          <div class="flex items-center gap-4 mt-4">
            <div class="w-14 h-14 rounded-2xl bg-[var(--secondary)] grid place-items-center font-heading text-[var(--primary)]">${h.name.split(' ').map(w=>w[0]).slice(0,2).join('')}</div>
            <div>
              <h3 class="font-heading text-lg text-[var(--primary)]">${h.name}</h3>
              <p class="text-sm text-[var(--muted)]">${starEmoji(h.stars)} ${h.rating.toFixed(1)}</p>
            </div>
          </div>
          <p class="mt-3 text-sm text-[var(--muted)]">${h.area}</p>
          <div class="mt-3 flex flex-wrap gap-2">
            ${h.amenities.slice(0,3).map(a=>`<span class="hotel-badge">${a}</span>`).join('')}
          </div>
          <div class="mt-4">
            <button class="btn-ghost text-sm" onclick="openHotelDetail('${h.id}')">Lihat Detail</button>
          </div>
        `;
        hotelTrack.appendChild(card);
      });
      buildDots();
      hotelIndex = 0; slideHotels(0);
    }
    function buildDots(){
      dotsWrap.innerHTML = '';
      const count = filtered.length;
      const visible = getVisibleCount();
      const pages = Math.max(1, count - visible + 1);
      for(let i=0;i<pages;i++){
        const dot = document.createElement('span');
        dot.className = 'dot';
        dot.dataset.dot = i;
        dot.onclick = ()=>{ hotelIndex = i; slideHotels(0); };
        dotsWrap.appendChild(dot);
      }
      updateDots();
    }

    // Slider logic
    let hotelIndex = 0;
    function getVisibleCount(){
      const w = window.innerWidth;
      if(w>=1024) return 3;
      if(w>=768) return 2;
      return 1;
    }
    function updateDots(){
      const dots = Array.from(dotsWrap.querySelectorAll('.dot'));
      dots.forEach((d,i)=> d.classList.toggle('active', i===hotelIndex));
    }
    function slideHotels(dir){
      const cardEls = hotelTrack.children;
      if(cardEls.length===0) return;
      const gap = 24; // gap-6
      const cardWidth = cardEls[0].getBoundingClientRect().width + gap;
      const maxIndex = Math.max(0, filtered.length - getVisibleCount());
      hotelIndex = Math.max(0, Math.min(maxIndex, hotelIndex + dir));
      hotelTrack.style.transform = `translateX(${-hotelIndex * cardWidth}px)`;
      updateDots();
    }
    window.addEventListener('resize', ()=>{ buildDots(); });

    // Filter + search
    function filterHotels(type){
      const q = document.getElementById('hotelSearch').value.toLowerCase().trim();
      filtered = hotels.filter(h=>{
        const starOk = type==='all' ? true : String(h.stars)===type;
        const textOk = !q || [h.name,h.area,h.address,(h.notes||'')].join(' ').toLowerCase().includes(q);
        return starOk && textOk;
      });
      renderHotels();
    }
    document.getElementById('hotelSearch').addEventListener('input', ()=>filterHotels('all'));

    // Hotel detail modal
    function openHotelDetail(id){
      const h = hotels.find(x=>x.id===id);
      if(!h) return;
      document.getElementById('hotelTitle').textContent = h.name;
      document.getElementById('hotelDetail').innerHTML = `
        <div><span class="font-semibold text-[var(--text)]">Kelas:</span> ${starEmoji(h.stars)} • Rating ${h.rating.toFixed(1)}</div>
        <div><span class="font-semibold text-[var(--text)]">Area:</span> ${h.area}</div>
        <div><span class="font-semibold text-[var(--text)]">Alamat:</span> ${h.address}</div>
        <div><span class="font-semibold text-[var(--text)]">Jarak/Patokan:</span> ${h.distance}</div>
        <div><span class="font-semibold text-[var(--text)]">Fasilitas:</span> ${h.amenities.join(', ')}</div>
        <div class="pt-2">
          <a class="btn-ghost text-sm" href="${h.link}" target="_blank" rel="noopener noreferrer">Kunjungi Situs</a>
        </div>
      `;
      document.getElementById('hotelContact').innerHTML = `
        <div>Tel: ${h.phone}</div>
        <div>Email: —</div>
        <div>Website: <a class="underline" href="${h.link}" target="_blank" rel="noopener noreferrer">${h.link.replace('https://','')}</a></div>
      `;
      document.getElementById('hotelNotes').textContent = h.notes || '-';

      // Render galeri foto hotel (jika sudah ada)
      const wrap = document.getElementById('hotelGallery');
      wrap.innerHTML = '';
      const photos = (window.hotelPhotos?.[id]||[]);
      if(photos.length){
        photos.forEach(url=>{
          const a = document.createElement('a');
          a.href = url; a.target = '_blank'; a.rel='noopener noreferrer';
          a.className = 'block aspect-[4/3] rounded-xl overflow-hidden bg-white/70';
          const img = document.createElement('img');
          img.src = url;
          img.alt = 'Foto Hotel';
          img.className = 'w-full h-full object-cover';
          img.onerror = function(){ this.src=''; this.alt='Image failed to load'; this.style.display='none'; };
          a.appendChild(img);
          wrap.appendChild(a);
        });
      }else{
        wrap.innerHTML = '<div class="p-3 rounded-xl border bg-white text-xs text-[var(--muted)]">Belum ada foto.</div>';
      }

      const modal = document.getElementById('hotelModal');
      modal.classList.remove('hidden'); modal.classList.add('flex');
      requestAnimationFrame(()=>modal.querySelector('.modal-enter').classList.add('in'));
    }

    // Simpan foto hotel di memori
    window.hotelPhotos = window.hotelPhotos || {};
    function promptAddPhoto(id){
      const url = prompt('Tempel tautan gambar (https://...) untuk hotel ini');
      if(!url) return;
      if(!/^https:\/\//i.test(url)) { alert('Pastikan URL diawali https://'); return; }
      (window.hotelPhotos[id] ||= []).push(url.trim());
      showToast('Foto ditambahkan! Buka detail hotel untuk melihat.');
    }
    function closeHotelModal(){
      const modal = document.getElementById('hotelModal');
      modal.classList.add('hidden'); modal.classList.remove('flex');
      modal.querySelector('.modal-enter').classList.remove('in');
    }

    // Init hotel render
    renderHotels();

    // Download guide
    function downloadGuide(){
      const blob = new Blob([`Panduan Pengguna Ruang Dinamis\n\n- Pinjam ruang rapat\n- Ajukan peminjaman mobil\n- Lihat referensi hotel\n\n© ${new Date().getFullYear()} Ruang Dinamis`], {type:'text/plain'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'Panduan-Ruang-Dinamis.txt';
      document.body.appendChild(a); a.click();
      URL.revokeObjectURL(url); a.remove();
      const t = document.getElementById('toast');
      t.classList.remove('hidden'); setTimeout(()=> t.classList.add('hidden'), 1600);
    }

    // Protokol modal handlers
    const PROTOKOL_NUMBERS = {
      PROTOKOL_I: '',
      PROTOKOL_II: '',
      PROTOKOL_III: ''
    };
    function openProtokolModal(){
      const modal = document.getElementById('protokolModal');
      modal.classList.remove('hidden'); modal.classList.add('flex');
      requestAnimationFrame(()=>modal.querySelector('.modal-enter').classList.add('in'));
    }
    function closeProtokolModal(){
      const modal = document.getElementById('protokolModal');
      modal.classList.add('hidden'); modal.classList.remove('flex');
      modal.querySelector('.modal-enter').classList.remove('in');
    }
    function openWhatsApp(key){
      const num = PROTOKOL_NUMBERS[key] || '';
      if(!num){ alert('Nomor WhatsApp belum diisi.'); return; }
      const url = `https://wa.me/${num}`;
      window.open(url, '_blank');
    }

    // Info placeholder
    function openInfo(title){ alert(`Anda membuka: ${title}`); }

    // ============ Vendor Data & UI ============
    const VENDOR_DATA = {
      snack: [
        { id:'parsley', name:'Parsley', tag:'Premium', emoji:'🥨', desc:'Pilihan mewah dengan kue modern dan tradisional dalam kemasan elegan. Cocok untuk acara formal.' },
        { id:'pandan', name:'Pandan Leaf', tag:'Tradisional', emoji:'🍮', desc:'Spesialis jajanan pasar otentik dengan cita rasa Nusantara. Ideal untuk menonjolkan kekhasan lokal.' },
        { id:'swiss', name:'Swiss House', tag:'Eropa', emoji:'🥐', desc:'Menawarkan pastry dan bakery premium bergaya Eropa. Memberikan sentuhan internasional dan mewah.' },
        { id:'cestmoi', name:"C'est Moi", tag:'Artisan', emoji:'🍰', desc:'Kue dengan desain unik dan Instagramable. Pilihan tepat untuk acara kreatif.' },
        { id:'kangen', name:'Kangen Omah', tag:'Rumahan', emoji:'🍩', desc:'Jajanan pasar dengan rasa rumahan yang lezat dan harga terjangkau. Cocok untuk acara santai.' },
        { id:'trubus', name:'Trubus', tag:'Sehat', emoji:'🍎', desc:'Menyediakan snack dan olahan buah yang sehat dan segar. Alternatif yang lebih ringan dan bernutrisi.' },
        { id:'jasmine', name:'Jasmine', tag:'Klasik', emoji:'🍪', desc:'Fokus pada kue kering dan bolu jadul. Ideal sebagai pendamping kopi atau teh.' },
        { id:'arya', name:'Arya Snack', tag:'Fleksibel', emoji:'🎯', desc:'Paket dapat disesuaikan dengan anggaran. Solusi tepat untuk acara berskala besar.' },
      ],
      catering: [
        { id:'sono', name:'Sono Kembang', tag:'Pionir Jogja', emoji:'🍽️', desc:'Ahli masakan Jawa klasik dengan porsi berlimpah. Unggulan untuk acara keluarga dan syukuran.' },
        { id:'bale', name:'Bale Raos', tag:'Keraton', emoji:'👑', desc:'Menyajikan hidangan eksklusif khas Keraton Yogyakarta. Pengalaman kuliner bersejarah untuk jamuan VIP.' },
        { id:'minang', name:'Duta Minang', tag:'Padang', emoji:'🌶️', desc:'Spesialis masakan Padang dengan bumbu rempah yang kuat dan berani. Tepat untuk pecinta rasa pedas.' },
        { id:'buruj', name:'Al-Buruj', tag:'Timur Tengah', emoji:'🧆', desc:'Cita rasa otentik Timur Tengah seperti nasi kebuli dan olahan kambing. Untuk acara spesial & perayaan.' },
        { id:'nusantara', name:'Nusantara Catering', tag:'Serbaguna', emoji:'🗺️', desc:'Solusi fleksibel dengan menu dari seluruh Indonesia. Ideal untuk acara dengan tamu beragam.' },
      ]
    };
    const VENDOR_WA = { // isi nanti dengan format 62xxxxxxxxxx
      parsley:'', pandan:'', swiss:'', cestmoi:'', kangen:'', trubus:'', jasmine:'', arya:'',
      sono:'', bale:'', minang:'', buruj:'', nusantara:''
    };

    // Detail tambahan per vendor (harga, minimal order, area, kelebihan, catatan)
    const VENDOR_INFO = {
      parsley:   { strengths:'Kemasan elegan, pilihan menu luas, kualitas konsisten', price:'± Rp25.000 – Rp55.000/box', minOrder:'20–50 box (tergantung paket)', area:'Kota Yogyakarta & sekitarnya', notes:'Bisa custom kartu ucapan & logo' },
      pandan:    { strengths:'Rasa autentik, varian jajanan pasar lengkap',           price:'± Rp12.000 – Rp30.000/box', minOrder:'20 box',                       area:'DIY & sekitarnya',               notes:'Bisa request menu tanpa santan/gula' },
      swiss:     { strengths:'Croissant, puff, dan cake premium',                     price:'± Rp30.000 – Rp65.000/box', minOrder:'20 box',                       area:'Yogyakarta pusat & radius 15 km',notes:'Pre-order H-1 untuk menu tertentu' },
      cestmoi:   { strengths:'Presentasi cantik, tema bisa disesuaikan',              price:'± Rp28.000 – Rp60.000/box', minOrder:'15–30 box',                    area:'Kota Yogyakarta',                notes:'Tersedia opsi low sugar' },
      kangen:    { strengths:'Harga ramah, rasa familiar',                            price:'± Rp10.000 – Rp22.000/box', minOrder:'20 box',                       area:'DIY',                            notes:'Campur menu tradisional & modern' },
      trubus:    { strengths:'Buah segar, jus, snack panggang',                       price:'± Rp15.000 – Rp35.000/box', minOrder:'15 box',                       area:'DIY',                            notes:'Opsi vegan & tanpa telur tersedia' },
      jasmine:   { strengths:'Aneka kue kering, bolu butter klasik',                  price:'± Rp12.000 – Rp28.000/box', minOrder:'20 box',                       area:'Kota Yogyakarta & sekitar',      notes:'Tersedia toples hampers' },
      arya:      { strengths:'Paket skala besar, fleksibel komposisi',                price:'Mulai Rp9.000/box (custom)', minOrder:'50 box (bisa dinego)',         area:'DIY & kabupaten sekitar',        notes:'Gratis ongkir untuk jumlah tertentu' },
      
      sono:      { strengths:'Gudeg, ayam bacem, sayur Jawa lengkap',                 price:'± Rp30.000 – Rp65.000/pax', minOrder:'30 pax',                       area:'DIY',                            notes:'Paket prasmanan & box tersedia' },
      bale:      { strengths:'Menu kerajaan, plating elegan',                         price:'± Rp60.000 – Rp120.000/pax',minOrder:'25 pax',                       area:'DIY (prioritas pusat kota)',     notes:'Pre-booking disarankan H-3' },
      minang:    { strengths:'Rendang, ayam pop, sambal ijo',                         price:'± Rp28.000 – Rp55.000/pax', minOrder:'25 pax',                       area:'DIY',                            notes:'Level pedas dapat diatur' },
      buruj:     { strengths:'Kambing guling, nasi kebuli, hummus',                   price:'± Rp45.000 – Rp95.000/pax', minOrder:'25–30 pax',                    area:'DIY',                            notes:'Menu halal, tanpa babi' },
      nusantara: { strengths:'Mix & match menu daerah',                               price:'± Rp30.000 – Rp80.000/pax', minOrder:'30 pax',                       area:'DIY & sekitar',                  notes:'Bisa all-in (alat saji & server)' }
    };

    let currentVendorTab = 'snack';
    function vendorCard(v){
      return `
        <article class="card p-5 flex flex-col">
          <div class="flex items-center justify-between gap-3">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 rounded-2xl bg-[var(--secondary)] grid place-items-center text-xl">${v.emoji}</div>
              <div>
                <h3 class="font-heading text-lg text-[var(--primary)]">${v.name}</h3>
                <p class="text-xs text-[var(--muted)]">${v.tag}</p>
              </div>
            </div>
          </div>
          <p class="mt-3 text-sm text-[var(--muted)]">${v.desc}</p>
          <div class="mt-4 flex gap-2">
            <button class="btn-primary text-sm" onclick="toggleVendor('${v.id}')">Ringkasan</button>
            <button class="btn-ghost text-sm" title="Hubungi via WhatsApp" onclick="vendorWhatsApp('${v.id}','${v.name}')">WhatsApp</button>
          </div>
          <div id="detail-${v.id}" class="mt-4 hidden">
            <div class="p-4 rounded-xl border bg-white text-sm text-[var(--muted)] space-y-2">
              <div><span class="font-semibold text-[var(--text)]">Deskripsi:</span> ${v.desc}</div>
              <div><span class="font-semibold text-[var(--text)]">Kelebihan:</span> ${VENDOR_INFO[v.id]?.strengths || '—'}</div>
              <div class="grid grid-cols-2 gap-3">
                <div><span class="font-semibold text-[var(--text)]">Harga:</span> ${VENDOR_INFO[v.id]?.price || '—'}</div>
                <div><span class="font-semibold text-[var(--text)]">Minimal Order:</span> ${VENDOR_INFO[v.id]?.minOrder || '—'}</div>
                <div><span class="font-semibold text-[var(--text)]">Area Layanan:</span> ${VENDOR_INFO[v.id]?.area || '—'}</div>
                <div><span class="font-semibold text-[var(--text)]">Catatan:</span> ${VENDOR_INFO[v.id]?.notes || '—'}</div>
              </div>
            </div>
          </div>
        </article>
      `;
    }
    function renderVendors(){
      const host = document.getElementById('vendorList');
      const list = VENDOR_DATA[currentVendorTab];
      host.innerHTML = list.map(v=>vendorCard(v)).join('');
      updateTabActive();
    }
    function updateTabActive(){
      document.getElementById('tabSnack').classList.toggle('bg-[var(--primary)]', currentVendorTab==='snack');
      document.getElementById('tabSnack').classList.toggle('text-white', currentVendorTab==='snack');
      document.getElementById('tabCatering').classList.toggle('bg-[var(--primary)]', currentVendorTab==='catering');
      document.getElementById('tabCatering').classList.toggle('text-white', currentVendorTab==='catering');
    }
    function switchVendorTab(tab){ currentVendorTab = tab; renderVendors(); }
    function toggleVendor(id){
      const el = document.getElementById('detail-'+id);
      if(!el) return; el.classList.toggle('hidden');
    }
    function expandAllVendors(){
      document.querySelectorAll('[id^="detail-"]').forEach(el=>el.classList.remove('hidden'));
    }
    function collapseAllVendors(){
      document.querySelectorAll('[id^="detail-"]').forEach(el=>el.classList.add('hidden'));
    }
    function vendorWhatsApp(id, name){
      const num = VENDOR_WA[id] || '';
      if(!num){ alert(`Nomor WhatsApp ${name} belum diisi.`); return; }
      window.open(`https://wa.me/${num}`,'_blank');
    }

    // render on load
    renderVendors();

    // ================== Kalender: Load CSV & Render Month ==================
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSVXkU63oXf5hL-9p_tqZfcNuj2YcxqtgVe_S3MEUvs-pju4R1MHCfJMMpCWazENZb7CjBZnV5wViVq/pub?gid=1711685001&single=true&output=csv";
    const calGrid = document.getElementById('calGrid');
    const calTitle = document.getElementById('calTitle');
    const calLoading = document.getElementById('calLoading');
    const calError = document.getElementById('calError');
    const prevBtn = document.getElementById('prevMonthBtn');
    const nextBtn = document.getElementById('nextMonthBtn');
    const todayBtn = document.getElementById('todayBtn');

    let events = []; // {date: 'YYYY-MM-DD', title:'...', time:'', location:''}
    let viewYear, viewMonth; // month: 0-11

    function csvParse(text){
      const rows = [];
      const lines = text.split(/\r?\n/).filter(l=>l.trim().length>0);
      for(const line of lines){
        const cols = [];
        let cur = '', inQuotes = false;
        for(let i=0;i<line.length;i++){
          const ch = line[i];
          if(ch === '"'){
            if(inQuotes && line[i+1]==='"'){ cur+='"'; i++; }
            else inQuotes = !inQuotes;
          }else if(ch === ',' && !inQuotes){
            cols.push(cur); cur='';
          }else{
            cur+=ch;
          }
        }
        cols.push(cur);
        rows.push(cols.map(c=>c.trim()));
      }
      return rows;
    }

    function normalizeDate(v){
      if(!v) return null;
      // Paksa baca dd/mm/yyyy sebagai prioritas utama
      const m1 = /^(\d{1,2})[\/](\d{1,2})[\/](\d{4})$/.exec(String(v).trim());
      if(m1){ return new Date(+m1[3], +m1[2]-1, +m1[1]); }
      // Dukung juga dd-mm-yyyy
      const m1b = /^(\d{1,2})[-](\d{1,2})[-](\d{4})$/.exec(String(v).trim());
      if(m1b){ return new Date(+m1b[3], +m1b[2]-1, +m1b[1]); }
      // Terakhir, coba ISO yyyy-mm-dd
      const m2 = /^(\d{4})[\-](\d{1,2})[\-](\d{1,2})$/.exec(String(v).trim());
      if(m2){ return new Date(+m2[1], +m2[2]-1, +m2[3]); }
      // Jika Google Sheets mengekspos format lokal seperti 3/9/2025 14:00
      const dt = new Date(v);
      return isNaN(dt) ? null : dt;
    }

    function toYMD(d){ const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const day=String(d.getDate()).padStart(2,'0'); return `${y}-${m}-${day}`; }

    function pickColumn(headers, candidates){
      const idx = headers.findIndex(h => candidates.includes(h.toLowerCase()));
      return idx >= 0 ? idx : -1;
    }

    async function loadCSV(){
      try{
        const res = await fetch(CSV_URL, {cache:'no-store'});
        const text = await res.text();
        const rows = csvParse(text);
        if(rows.length<=1){ throw new Error('No data'); }
        // Samakan dengan header: Nama Agenda | Tempat | Tanggal Mulai | Tanggal Selesai | Jam
        const headers = rows[0].map(h=>h.toLowerCase());
        const titleIdx = pickColumn(headers, ['nama agenda','title','kegiatan','event','acara','subject','topik','description','deskripsi']);
        const locIdx   = pickColumn(headers, ['tempat','location','lokasi','room','ruang']);
        const startIdx = pickColumn(headers, ['tanggal mulai','tanggal','tgl','start date','start']);
        const endIdx   = pickColumn(headers, ['tanggal selesai','end date','end','selesai','finish']);
        const timeIdx  = pickColumn(headers, ['jam','time','waktu','start time']);

        const list = [];
        for(let i=1;i<rows.length;i++){
          const r = rows[i];
          const start = startIdx>=0 ? normalizeDate(r[startIdx]) : normalizeDate(r[0]);
          if(!start) continue;
          const end = endIdx>=0 && r[endIdx] ? normalizeDate(r[endIdx]) : start;
          const title = (titleIdx>=0 ? r[titleIdx] : r[1]) || 'Kegiatan';
          const rawTime = timeIdx>=0 ? (r[timeIdx]||'') : '';
          // Rapikan jam: dukung format "HH:MM - HH:MM" atau single jam
          let time = (rawTime||'').trim();
          // Normalisasi separator ke en dash dan pastikan 24-jam (biarkan angka apa adanya)
          time = time.replace(/\s*[-–—]\s*/g,'–');
          // Tambahkan leading zero untuk format H:MM
          time = time.replace(/\b(\d{1}):(\d{2})\b/g, (m,h,min)=>`${h.padStart(2,'0')}:${min}`);
          // Hilangkan AM/PM jika ada
          time = time.replace(/\s*(AM|PM|am|pm)\s*/g,'');
          const loc = locIdx>=0 ? (r[locIdx]||'') : '';

          // Buat event untuk setiap hari di rentang start..end (inklusif)
          const cursor = new Date(start.getFullYear(), start.getMonth(), start.getDate());
          const last = new Date(end.getFullYear(), end.getMonth(), end.getDate());
          while(cursor <= last){
            list.push({
              date: toYMD(cursor),
              title: title,
              time: time,
              end: '',
              location: loc
            });
            cursor.setDate(cursor.getDate()+1);
          }
        }
        events = list;
        calLoading.classList.add('hidden');
        renderCalendar();
      }catch(e){
        calLoading.classList.add('hidden');
        calError.classList.remove('hidden');
      }
    }

    function renderCalendar(){
      // Bangun rekap agenda bulan berjalan
      buildAgendaRecap();
      const now = new Date();
      if(viewYear==null){ viewYear = now.getFullYear(); viewMonth = now.getMonth(); }
      const first = new Date(viewYear, viewMonth, 1);
      const firstDay = (first.getDay()+6)%7; // make Monday=0
      const monthName = first.toLocaleString('id-ID', {month:'long', year:'numeric'});
      calTitle.textContent = monthName.charAt(0).toUpperCase() + monthName.slice(1);

      const daysInMonth = new Date(viewYear, viewMonth+1, 0).getDate();
      const daysPrev = new Date(viewYear, viewMonth, 0).getDate();
      const cells = [];
      // Previous month cells
      for(let i=firstDay-1;i>=0;i--){
        const d = daysPrev - i;
        cells.push({date: new Date(viewYear, viewMonth-1, d), out:true});
      }
      // Current month cells
      for(let d=1; d<=daysInMonth; d++){
        cells.push({date: new Date(viewYear, viewMonth, d), out:false});
      }
      // Next month padding to complete weeks (42 cells)
      while(cells.length % 7 !== 0) cells.push({date: new Date(viewYear, viewMonth+1, cells.length % 7), out:true});
      while(cells.length < 42) cells.push({date: new Date(viewYear, viewMonth+1, (cells.length- (firstDay+daysInMonth)) +1), out:true});

      calGrid.innerHTML = '';
      const todayYMD = toYMD(new Date());
      const map = events.reduce((acc, ev)=>{
        (acc[ev.date] ||= []).push(ev); return acc;
      }, {});
      cells.forEach(c=>{
        const ymd = toYMD(c.date);
        const dayEvents = map[ymd] || [];
        const box = document.createElement('button');
        box.type = 'button';
        box.className = `cal-day ${c.out?'out':''} ${ymd===todayYMD?'today':''}`;
        box.setAttribute('aria-label', `Tanggal ${c.date.toLocaleDateString('id-ID')}, ${dayEvents.length} kegiatan`);
        const head = document.createElement('div');
        head.className = 'date text-sm';
        head.textContent = c.date.getDate();
        box.appendChild(head);
        // Show up to 2 events
        dayEvents.slice(0,2).forEach(ev=>{
          const b = document.createElement('span');
          b.className = 'badge';
          const timeTxt = ev.time ? `${ev.time}${ev.end?`–${ev.end}`:''} • ` : '';
          b.textContent = `${timeTxt}${ev.title}`;
          box.appendChild(b);
        });
        if(dayEvents.length>2){
          const more = document.createElement('span');
          more.className = 'badge';
          more.textContent = `+${dayEvents.length-2} lainnya`;
          box.appendChild(more);
        }
        box.onclick = ()=> openDayModal(ymd, dayEvents);
        calGrid.appendChild(box);
      });
    }

    function shiftMonth(delta){
      viewMonth += delta;
      if(viewMonth<0){ viewMonth=11; viewYear--; }
      if(viewMonth>11){ viewMonth=0; viewYear++; }
      renderCalendar();
    }

    prevBtn.onclick = ()=>shiftMonth(-1);
    nextBtn.onclick = ()=>shiftMonth(1);
    todayBtn.onclick = ()=>{
      const n = new Date();
      viewYear = n.getFullYear();
      viewMonth = n.getMonth();
      renderCalendar();
    };

    // Modal untuk detail hari (pakai modal hotel agar simpel)
    function openDayModal(ymd, list){
      if(!list || list.length===0){ alert(`Tidak ada kegiatan pada ${ymd}`); return; }
      const modal = document.getElementById('hotelModal');
      document.getElementById('hotelTitle').textContent = `Kegiatan • ${new Date(ymd).toLocaleDateString('id-ID',{weekday:'long', day:'numeric', month:'long', year:'numeric'})}`;
      document.getElementById('hotelDetail').innerHTML = list.map(ev=>{
        const time = ev.time ? `${ev.time}${ev.end?`–${ev.end}`:''}` : 'Waktu: —';
        const loc = ev.location || 'Lokasi: —';
        return `<div class="p-3 rounded-lg border bg-white">
          <div class="font-semibold text-[var(--primary)]">${ev.title}</div>
          <div class="text-[var(--muted)]">${time}</div>
          <div class="text-[var(--muted)]">${loc}</div>
        </div>`;
      }).join('');
      document.getElementById('hotelContact').innerHTML = `<div class="text-[var(--muted)]">Total kegiatan hari ini: ${list.length}</div>`;
      document.getElementById('hotelNotes').textContent = 'Data diambil dari CSV yang Anda lampirkan.';
      modal.classList.remove('hidden'); modal.classList.add('flex');
      requestAnimationFrame(()=>modal.querySelector('.modal-enter').classList.add('in'));
    }

    function monthKey(d){ return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`; }

    let agendaPage = 0;
    const AGENDA_PER_PAGE = 10;
    function buildAgendaRecap(){
      const host = document.getElementById('agendaList');
      const info = document.getElementById('agendaInfo');
      const prev = document.getElementById('agendaPrev');
      const next = document.getElementById('agendaNext');
      if(!host) return;
      const base = new Date(viewYear ?? new Date().getFullYear(), (viewMonth ?? new Date().getMonth()), 1);
      const key = monthKey(base);
      const monthEvents = events.filter(ev=>ev.date.startsWith(key)).sort((a,b)=> a.date.localeCompare(b.date));
      const totalPages = Math.max(1, Math.ceil(monthEvents.length / AGENDA_PER_PAGE));
      agendaPage = Math.min(agendaPage, totalPages-1);
      const start = agendaPage * AGENDA_PER_PAGE;
      const pageItems = monthEvents.slice(start, start + AGENDA_PER_PAGE);

      host.innerHTML = pageItems.length ? pageItems.map(ev=>{
        const d = new Date(ev.date);
        const day = d.toLocaleDateString('id-ID',{weekday:'short', day:'2-digit', month:'short'});
        const time = ev.time ? ` • ${ev.time}` : '';
        const loc = ev.location ? ` • ${ev.location}` : '';
        return `<div class="p-3 rounded-xl border bg-white flex flex-wrap items-center gap-2">
          <span class="font-medium text-[var(--text)]">${day}</span>
          <span>— ${ev.title}${time}${loc}</span>
        </div>`;
      }).join('') : '<div class="p-3 rounded-xl border bg-white">Tidak ada agenda pada bulan ini.</div>';

      if(info) info.textContent = `Halaman ${totalPages ? agendaPage+1 : 1} dari ${totalPages}`;
      if(prev) prev.disabled = agendaPage<=0;
      if(next) next.disabled = agendaPage>=totalPages-1;
    }

    // Navigasi halaman rekap
    document.addEventListener('click', (e)=>{
      if(e.target && e.target.id==='agendaPrev'){
        agendaPage = Math.max(0, agendaPage-1); buildAgendaRecap();
      }
      if(e.target && e.target.id==='agendaNext'){
        agendaPage = agendaPage+1; buildAgendaRecap();
      }
    });

    // Salin rekap ke clipboard
    const copyBtn = document.getElementById('copyAgendaBtn');
    if(copyBtn){
      copyBtn.addEventListener('click', ()=>{
        const wrapper = document.getElementById('agendaList');
        const text = wrapper ? wrapper.innerText : '';
        if(!text){ alert('Belum ada agenda untuk disalin.'); return; }
        navigator.clipboard.writeText(text).then(()=>{
          showToast('Rekap agenda disalin!');
        }).catch(()=>{
          alert('Gagal menyalin. Izinkan akses clipboard pada browser.');
        });
      });
    }

    const copyTodayBtn = document.getElementById('copyTodayBtn');
    if(copyTodayBtn){
      copyTodayBtn.addEventListener('click', ()=>{
        const today = new Date();
        const ymd = `${today.getFullYear()}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;
        const list = events.filter(ev=>ev.date===ymd);
        const text = list.length ? list.map(ev=>`${ev.title}${ev.time?` • ${ev.time}`:''}${ev.location?` • ${ev.location}`:''}`).join('\n') : 'Tidak ada agenda hari ini.';
        navigator.clipboard.writeText(text).then(()=>{
          showToast('Agenda hari ini disalin!');
        }).catch(()=>{
          alert('Gagal menyalin. Izinkan akses clipboard pada browser.');
        });
      });
    }

    function showToast(msg){
      const t = document.getElementById('toast');
      if(!t) return;
      t.querySelector('div').textContent = msg;
      t.classList.remove('hidden');
      setTimeout(()=> t.classList.add('hidden'), 1600);
    }

    // Load CSV on start
    loadCSV();
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9846b224c16c44a1',t:'MTc1ODc2MzE5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
